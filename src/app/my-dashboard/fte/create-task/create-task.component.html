<p-dialog header="Create Task" [(visible)]="createTaskModal" [modal]="true" [draggable]="false" [style]="{'width': '50%'}" [maximizable]="false" (onHide)="cancelFormSub('createTask')" [closable]='false'>


    <div class="pdialogButton p-col-12 p-grid p-jc-end">
        <button type="button" label="Create" [disabled]="submitBtn.isClicked" (click)="onFormSubmit('createTask')" pButton icon="pi pi-save" id="saveBooking" [ngStyle]="{'cursor':'pointer' }" class="p-mx-1 p-button-raised p-button-danger"></button>
        <button type="button" pButton icon="pi pi-times" (click)="cancelFormSub('createTask')" label="Cancel" class="p-button-raised p-button-danger"></button>
    </div>
    <p-scrollPanel [style]="{height: '400px'}">
        <form [formGroup]="create_task_form" class="p-mt-5 p-mr-2 ">

            <div class="p-col p-grid p-p-1">
                <div class="p-col p-grid p-p-0">
                    <label for="ProjectCode" class="p-col-12 p-m-0 p-md-4 p-mb-md-0 p-p-3">Project Code:</label>
                    <div class="p-col-12 p-md-8">
                        <p-dropdown resetFilterOnHide="true" [options]="fteProjectsList" placeholder="Select Project code" [style]="{'width':'100%'}" formControlName="ProjectCode" optionLabel="ProjectCode" (onChange)="onChangeDD($event.value, 'ProjectCode')">
                        </p-dropdown>
                        <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.ProjectCode.errors">
                            <div *ngIf="isValidCreateTaskForm.ProjectCode.errors.required" style="color:red;" style="color:red;">
                                ProjectCode is required.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-col p-grid p-p-0">
                    <label for="Milestones" class="p-col-12 p-m-0 p-md-4 p-mb-md-0 p-p-3"> Milestones:</label>
                    <div class="p-col-12 p-md-8">
                        <p-dropdown [options]="milestonesList" placeholder="Select milestone" optionLabel="label" [style]="{'width':'100%'}" formControlName="Milestones" (onChange)="onChangeDD($event.value, 'Milestone')">
                        </p-dropdown>
                        <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.Milestones.errors">
                            <div *ngIf="isValidCreateTaskForm.Milestones.errors.required" style="color:red;">Milestone is required.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-col p-grid p-p-1">

                <div class="p-col p-grid p-p-0">
                    <label for="Submilestones" class="p-col-12 p-m-0 p-md-2 p-mb-md-0 p-p-3"> Sub milestones:</label>
                    <div class="p-col-12 p-md-10">
                        <p-dropdown #dd editable="true" [options]="subMilestonesList" [style]="{'width':'100%'}" formControlName="SubMilestones" optionLabel="label" (onChange)="onChangeDD($event.value, 'SubMilestone')" (input)="onSearchChange($event.target.value)" (click)="clearFilter(dd)">
                        </p-dropdown>
                        <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.SubMilestones.errors">
                            <div style="color: red;" *ngIf="isValidCreateTaskForm.SubMilestones.errors">Sub Milestone is required.</div>
                        </div>
                        <div *ngIf="isValidCreateTaskForm.SubMilestones.hasError('maxlength')">
                            <div style="color: red;">Maximum Sub Milestone character length is 30 only.</div>
                        </div>
                        <div>
                            <div style="color: #C53E3E;">Preferably PUB ID </div>
                            <div>{{this.create_task_form.value.SubMilestones.length}} / 30</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-col p-grid p-p-1">
                <div class="p-col p-grid p-p-0">
                    <label for=" StartDate" class="p-col-12 p-m-0 p-md-4 p-mb-md-0 p-p-3">  Start Date:</label>
                    <div class="p-col-12 p-md-8 p-grid p-d-flex">
                        <div class="p-col">
                            <p-calendar [style]="{'border': '1px solid !important'}" [minDate]="minDateValue" placeholder="Select Start Date" formControlName="StartDate" [maxDate]="maxDate" [disabledDays]="[0,6]" dateFormat="M dd, yy" yearRange="{{yearsRange}}" appendTo="body" [monthNavigator]="true"
                                [showIcon]="true" (onClose)="onCloseStartDate()" [yearNavigator]="true">
                            </p-calendar>
                            <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.StartDate.errors">
                                <div style="color: red;">Start Date is required.</div>
                            </div>
                        </div>
                        <div class="p-col">
                            <div class="p-d-flex">
                                <input placeholder="Select Start Time" style="padding:8px;width: 75%;  border: 1px solid #a6a6a6; border-radius: 4px;" aria-label="12hr format" [ngxTimepicker]="defaultStartTime" formControlName="StartTime" [value]="'09:00 AM'" [format]="12" readonly>
                                <ngx-material-timepicker-toggle [for]="defaultStartTime"></ngx-material-timepicker-toggle>
                                <ngx-material-timepicker #defaultStartTime [minutesGap]="15" [enableKeyboardInput]="false" (closed)="SetTime(create_task_form.value.StartTime, 'startTime')" [ngxMaterialTimepickerTheme]="darkTheme">
                                </ngx-material-timepicker>


                            <!-- </div> -->
                            <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.StartTime.errors">
                                <div style="color: red;">Start time is required.</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-col p-grid p-p-0">
                    <label for="EndDate" class="p-col-12 p-m-0 p-md-4 p-mb-md-0 p-p-3"> End Date:</label>
                    <div class="p-col-12 p-md-8 p-grid p-d-flex">
                        <div class="p-col">
                            <p-calendar [style]="{'border': '1px solid !important'}" [minDate]="minDateValue" placeholder="Select Start Date" formControlName="StartDate" [maxDate]="maxDate" [disabledDays]="[0,6]" dateFormat="M dd, yy" yearRange="{{yearsRange}}" appendTo="body" [monthNavigator]="true"
                                [showIcon]="true" (onClose)="onCloseStartDate()" [yearNavigator]="true">
                            </p-calendar>
                            <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.StartDate.errors">
                                <div style="color: red;">Start Date is required.</div>
                            </div>
                        </div>
                        <div class="p-col">
                            <div class="p-d-flex">
                                <input placeholder="Select Start Time" style="padding:8px;width: 75%;border: 1px solid #a6a6a6; border-radius: 4px;" aria-label="12hr format" [ngxTimepicker]="defaultEndTime" formControlName="EndTime" [value]="'07:00 PM'" [format]="12" readonly>
                                <ngx-material-timepicker-toggle [for]="defaultEndTime"></ngx-material-timepicker-toggle>
                                <ngx-material-timepicker #defaultEndTime [minutesGap]="15" [enableKeyboardInput]="false" (closed)="SetTime(create_task_form.value.EndTime, 'endTime')" [ngxMaterialTimepickerTheme]="darkTheme">
                                </ngx-material-timepicker>

                            <!-- </div> -->
                            <div *ngIf="formSubmit.isSubmit &&  isValidCreateTaskForm.StartTime.errors">
                                <div style="color: red;">End time is required.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-col p-grid p-p-1">
                <div class="p-col p-grid p-p-0">
                    <label for="Scope" class="p-col-12 p-m-0 p-md-2 p-mb-md-0 p-p-3">Scope:</label>
                    <div class="p-col-12 p-md-10">
                        <textarea class="p-col-12" [rows]="5" [cols]="60" formControlName="Comments" pInputTextarea maxlength="100"></textarea>
                        <span style="padding-left: 5px;">{{this.create_task_form.value.Comments.length}} / 100</span>
                        <div *ngIf="this.create_task_form.value.Comments.length >= 100 ">
                            <span style="color: red;">Task scope maximum length is 100</span>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </p-scrollPanel>
</p-dialog>
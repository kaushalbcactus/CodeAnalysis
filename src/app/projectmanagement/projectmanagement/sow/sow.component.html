<div [hidden]='isAllSOWLoaderHidden'>
    <div id="allSOWLoader"></div>
    <div id="allSOWLoaderText">Loading...</div>
</div>
<div class="allSOW-section" [hidden]='isAllSOWTableHidden'>
    <p-table #allProjectRef [columns]="displayedColumns" [value]="pmObject.allSOWArrayCopy" [paginator]="true"
        [rows]="5" [lazy]="true" [totalRecords]="pmObject.totalRecords.AllSOW" [loading]="pmObject.loading.AllSOW"
        (onLazyLoad)="lazyLoadTask($event)" [lazyLoadOnInit]="false">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                    {{ col.header }}
                    <p-sortIcon [field]="col.field"></p-sortIcon>
                </th>
                <th class="lastColumnWidth"></th>
            </tr>
            <tr>
                <th *ngFor="let col of columns" [ngSwitch]="col.field">
                    <p-multiSelect *ngSwitchCase="'SOWCode'" [options]="allSOW.sowCodeArray" defaultLabel="All"
                        (onChange)="allProjectRef.filter($event.value, col.field, 'in')">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'ShortTitle'" [options]="allSOW.shortTitleArray" defaultLabel="All"
                        (onChange)="allProjectRef.filter($event.value, col.field, 'in')">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'ClientLegalEntity'" [options]="allSOW.clientLegalEntityArray"
                        defaultLabel="All" (onChange)="allProjectRef.filter($event.value, col.field, 'in')">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'POC'" [options]="allSOW.pocArray" defaultLabel="All"
                        (onChange)="allProjectRef.filter($event.value, col.field, 'in')">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'CreatedBy'" [options]="allSOW.createdByArray" defaultLabel="All"
                        (onChange)="allProjectRef.filter($event.value, col.field, 'in')">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'CreatedDate'" [options]="allSOW.createdDateArray" defaultLabel="All"
                        (onChange)="allProjectRef.filter($event.value, col.field, 'in')">
                    </p-multiSelect>
                </th>
                <th class="lastColumnWidth"></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-task>
            <tr>
                <td>{{task.SOWCode}}</td>
                <td>{{task.ShortTitle}}</td>
                <td>{{task.ClientLegalEntity}}</td>
                <td>{{task.POC}}</td>
                <td>{{task.CreatedBy}}</td>
                <td>{{task.CreatedDate}}</td>
                <td>
                    <p-menu [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" #menu [model]="popItems"
                        [popup]="true" appendTo="body">
                    </p-menu>
                    <i class="pi pi-ellipsis-v" style="font-size:2em;cursor: pointer;"
                        (click)="storeRowData(task, menu); menu.toggle($event);"></i>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
<div class="all-project-section">
    <p-dialog [(visible)]="pmObject.isProjectVisible" [modal]="true" [style]="{width: '1300px'}">
        <p-header>View Projects</p-header>
        <mat-accordion>
            <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)">
                <mat-expansion-panel-header>
                    <mat-panel-title style="color:#000000;">
                        &nbsp;&nbsp; Active Projects
                    </mat-panel-title>
                    <ng-template matExpansionPanelContent>
                        <div fxLayout="column" style="padding: 2vw;" fxLayoutAlign="center center"
                            [hidden]="activeProjectLoader">
                            <div id="mainLoader"></div>
                            <div id="mainLoaderText">Loading...</div>
                        </div>
                        <div [hidden]="isActiveProjectTableHidden">
                            <p-table #activeProject [columns]="projectsDisplayedColumns"
                                [value]="pmObject.allProjects.activeProjectCopyArray" [paginator]="true" [rows]="5"
                                [lazy]="true" [totalRecords]="pmObject.totalRecords.activeProject"
                                [loading]="pmObject.loading.activeProject"
                                (onLazyLoad)="activeProjectlazyLoadTask($event)" [lazyLoadOnInit]="false">
                                <ng-template pTemplate="caption">
                                    <div style="text-align: left">
                                        <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                                        <input type="text" pInputText size="50" placeholder="search"
                                            (input)="activeProject.filterGlobal($event.target.value, 'contains')"
                                            style="width:auto">
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="header" let-columns>
                                    <tr>
                                        <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                            {{ col.header }}
                                            <p-sortIcon [field]="col.field"></p-sortIcon>
                                        </th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData let-task>
                                    <tr [pContextMenuRow]="rowData">
                                        <td>{{task.DeliverableType}}</td>
                                        <td><a href="javascript:void(0)"
                                                (click)="navigateToProject(task)">{{task.ProjectCode}}</a></td>
                                        <td>{{task.Title}}</td>
                                        <td>{{task.Budget}}</td>
                                        <td>{{task.Status}}</td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </div>
                    </ng-template>
                </mat-expansion-panel-header>
            </mat-expansion-panel>
            <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)">
                <mat-expansion-panel-header>
                    <mat-panel-title style="color:#000000;">
                        &nbsp;&nbsp; Pipeline Projects
                    </mat-panel-title>
                    <ng-template matExpansionPanelContent>
                        <div fxLayout="column" style="padding: 2vw;" fxLayoutAlign="center center"
                            [hidden]="pipelineProjectLoader">
                            <div id="mainLoader"></div>
                            <div id="mainLoaderText">Loading...</div>
                        </div>
                        <div [hidden]="isPipelineProjectTableHidden">
                            <p-table #pipeLineProject [columns]="projectsDisplayedColumns"
                                [value]="pmObject.allProjects.pipelineProjectCopyArray" [paginator]="true" [rows]="5"
                                [lazy]="true" [totalRecords]="pmObject.totalRecords.pipelineProject"
                                [loading]="pmObject.loading.pipelineProject"
                                (onLazyLoad)="pipelineProjectlazyLoadTask($event)" [lazyLoadOnInit]="false">
                                <ng-template pTemplate="caption">
                                    <div style="text-align: left">
                                        <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                                        <input type="text" pInputText size="50" placeholder="search"
                                            (input)="pipeLineProject.filterGlobal($event.target.value, 'contains')"
                                            style="width:auto">
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="header" let-columns>
                                    <tr>
                                        <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                            {{ col.header }}
                                            <p-sortIcon [field]="col.field"></p-sortIcon>
                                        </th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData let-task>
                                    <tr [pContextMenuRow]="rowData">
                                        <td>{{task.DeliverableType}}</td>
                                        <td><a href="javascript:void(0)"
                                                (click)="navigateToProject(task)">{{task.ProjectCode}}</a></td>
                                        <td>{{task.Title}}</td>
                                        <td>{{task.Budget}}</td>
                                        <td>{{task.Status}}</td>
                                    </tr>
                                </ng-template>
                            </p-table>

                        </div>
                    </ng-template>
                </mat-expansion-panel-header>
            </mat-expansion-panel>
            <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)">
                <mat-expansion-panel-header>
                    <mat-panel-title style="color:#000000;">
                        &nbsp;&nbsp; InActive Projects
                    </mat-panel-title>
                    <ng-template matExpansionPanelContent>
                        <div fxLayout="column" style="padding: 2vw;" fxLayoutAlign="center center"
                            [hidden]="inActiveProjectLoader">
                            <div id="mainLoader"></div>
                            <div id="mainLoaderText">Loading...</div>
                        </div>
                        <div [hidden]="isInActiveProjectTableHidden">
                            <p-calendar [(ngModel)]="rangeDates" selectionMode="range" (onClose)="getInactiveProject()"
                                [style]="{'width':'130%'}" numberOfMonths='1' appendTo="body" dateFormat="dd M , yy"
                                [showIcon]="true" [disabledDays]="[0,6]" [readonlyInput]="true"
                                placeholder="Select Custom Dates" [style]="{'cursor': 'pointer'}"></p-calendar>
                            <p-table #inActiveProject [columns]="projectsDisplayedColumns"
                                [value]="pmObject.allProjects.inActiveProjectCopyArray" [paginator]="true" [rows]="5"
                                [lazy]="true" [totalRecords]="pmObject.totalRecords.inActiveProject"
                                [loading]="pmObject.loading.inActiveProject" (onLazyLoad)="inActivelazyLoadTask($event)"
                                [lazyLoadOnInit]="false">
                                <ng-template pTemplate="caption">
                                    <div style="text-align: left">
                                        <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
                                        <input type="text" pInputText size="50" placeholder="search"
                                            (input)="inActiveProject.filterGlobal($event.target.value, 'contains')"
                                            style="width:auto">
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="header" let-columns>
                                    <tr>
                                        <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                            {{ col.header }}
                                            <p-sortIcon [field]="col.field"></p-sortIcon>
                                        </th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData let-task>
                                    <tr [pContextMenuRow]="rowData">
                                        <td>{{task.DeliverableType}}</td>
                                        <td><a href="javascript:void(0)"
                                                (click)="navigateToProject(task)">{{task.ProjectCode}}</a></td>
                                        <td>{{task.Title}}</td>
                                        <td>{{task.Budget}}</td>
                                        <td>{{task.Status}}</td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </div>
                    </ng-template>
                </mat-expansion-panel-header>
            </mat-expansion-panel>
        </mat-accordion>
    </p-dialog>
</div>
<div *ngIf="pmObject.isSOWRightViewVisible" class="ng-right-side-overlay">
    <p-sidebar [(visible)]="pmObject.isSOWRightViewVisible" position="right" styleClass="ui-sidebar-md">
        <p-table [value]="sowViewDataArray">
            <ng-template pTemplate="header">
                <tr>
                    <th>Name</th>
                    <th>Value</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-task style="overflow: auto">
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">SOW ID</td>
                    <td>{{task.ID}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">SOW Code</td>
                    <td>{{task.SOWCode}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Client Legal Entity</td>
                    <td>{{task.ClientLegalEntity}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Billing Entity</td>
                    <td>{{task.BillingEntity}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Practice Area</td>
                    <td>{{task.PracticeArea}}</td>
                </tr>
                <tr>
                    <td colspan="2" [ngStyle]="{'color':'#d7181f'}">Client POC</td>
                </tr>
                <tr>
                    <td>{{task.PocText}}</td>
                    <td>{{task.PocOptionalText}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">SOW Title</td>
                    <td>{{task.SOWTitle}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">SOW Cretion Date</td>
                    <td>{{task.SOWCreationDate | date:'medium'}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">SOW Expiry Date</td>
                    <td>{{task.SOWExpiryDate | date:'medium'}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Status</td>
                    <td>{{task.Status}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Comments</td>
                    <td>{{task.Comments}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Currency</td>
                    <td>{{task.Currency}}</td>
                </tr>
                <tr>
                    <td colspan="2" [ngStyle]="{'color':'#d7181f'}"></td>
                </tr>
                <tr>
                    <td colspan="2" [ngStyle]="{'color':'#d7181f'}">Budget</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Total</td>
                    <td>{{task.Budget.Total}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Net</td>
                    <td>{{task.Budget.Net}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">OOP</td>
                    <td>{{task.Budget.OOP}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Tax</td>
                    <td>{{task.Budget.Tax}}</td>
                </tr>
                <tr>
                    <td colspan="2" [ngStyle]="{'color':'#d7181f'}"></td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">CM1</td>
                    <td>{{task.CM1Text}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">CM2</td>
                    <td>{{task.CM2Text}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Delivery1</td>
                    <td>{{task.DeliveryOptionalText}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">Delivery2</td>
                    <td>{{task.DeliveryText}}</td>
                </tr>
                <tr>
                    <td [ngStyle]="{'color':'#d7181f'}">SOW Owner</td>
                    <td>{{task.SOWOwnerText}}</td>
                </tr>
            </ng-template>
        </p-table>
    </p-sidebar>
</div>
<app-timeline-history #timelineRef></app-timeline-history>
<div class="p-m-1 p-grid p-jc-end">
    <div class="p-my-1" [hidden]='!(showNavigateSOW && showFilterOptions)'>
        <button *ngIf="CSButtonEnable" pButton type="button" label="CS Audit" [ngClass]="CSButton ? 'selectedAudit':''" class="p-mr-3 p-button-text p-button-raised  p-button-plain" (click)="showAllCSFinanceAudit('CS')"></button>

        <button *ngIf="FinanceButtonEnable" pButton type="button" label="Finance Audit" class="p-mr-3 p-button-text p-button-raised  p-button-plain" [ngClass]="FinanceButton ? 'selectedAudit':''" (click)="showAllCSFinanceAudit('Finance')"></button>

        <input class="p-mr-3" type="text" (keydown.enter)="searchClosedProject($event); $event.preventDefault()" (change)="searchClosedProject($event)" *ngIf="showProjectInput" id="projectCodeSelect" placeholder="Project Code" pInputText [(ngModel)]="providedProjectCode"
        />
        <p-dropdown class="p-mr-3 projectType" [options]="overAllValues" [(ngModel)]="selectedOption" styleClass="custom-dropDown-allprojects" optionLabel="name" (onChange)="onChangeSelect($event)"></p-dropdown>
    </div>
    <div class="p-d-flex">
        <mat-icon class="p-mr-3" style="font-size: 2.8em; 
        cursor: pointer;" [hidden]="hideExcelWithBudget" title="Export To Excel with Budget & Currency" (click)="convertToExcelFile(allProjectRef)"> local_atm</mat-icon>
        <i style="font-size: 1.8em;cursor: pointer;" (click)="pmCommonService.convertToExcelFile(allProjectRef)" title="Export To Excel" class="p-mt-2 fa fa-fw fa-file-excel-o"></i>
    </div>
</div>


<div class="p-d-flex p-flex-column" style="padding: 10vw;width: 100%;" *ngIf="!isAllProjectLoaderHidden">
    <div id="scInnerLoader"></div>
    <div id="scInnerLoaderText">Loading...</div>
</div>



<div class="p-col allProjects-section" [hidden]='isAllProjectTableHidden' hideshowMenu>
    <div *ngIf="showTable">
        <p-table #allProjectRef [columns]="displayedColumns" [value]="pmObject.allProjectsArray" [paginator]="true" [rows]="10" selectionMode="" exportFilename="All Projects" [rowsPerPageOptions]="[10,25,50]" [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [style]="{'font-size':'13px','min-height': '400px'}" styleClass="p-datatable-cactus p-datatable-gridlines" stateStorage="local" [stateKey]="hideExcelWithBudget ? 'MyDashboardProjects':'AllProjects'">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th class="firstColumnWidth">S.No</th>
                    <th [style]="{'width' : col.field ==='PrimaryResources' ? '11em': col.field ==='Molecule' ? '10%':'' }" *ngFor="let col of columns" [pSortableColumn]="col.field" [hidden]="!col.visibility">
                        <div class="p-d-flex p-jc-between p-ai-center">
                            {{col.header}}
                            <p-sortIcon [field]="col.field"></p-sortIcon>
                            <p-columnFilter *ngIf="col.header != ''  && col.field !='PrimaryResources' " [field]="col.field" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                                <ng-template pTemplate="header">
                                    <div class="p-px-3 p-pt-3 p-pb-0">
                                        <span class="p-text-bold"> {{col.header}} Picker</span>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                    <p-multiSelect [ngModel]="value" [options]="allProjects[col.field]" placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                        <ng-template let-option pTemplate="item">
                                            <div class="p-multiselect-representative-option">
                                                <span class="p-ml-1">{{option.label}}</span>
                                            </div>
                                        </ng-template>
                                    </p-multiSelect>
                                </ng-template>
                            </p-columnFilter>

                            <p-columnFilter *ngIf="col.header != ''  && col.field ==='PrimaryResources' " type="text" [field]="col.field" matchMode="contains" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false"></p-columnFilter>
                        </div>

                    </th>
                    <th class="lastColumnWidth"></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-task let-rowIndex="rowIndex">
                <tr>
                    <td>{{rowIndex+1}}</td>
                    <td>
                        <a *ngIf="showNavigateSOW" href="javascript:void(0)" (click)="navigateToSOW(task)">{{task.SOWCode}}</a>
                        <span *ngIf="!showNavigateSOW">{{task.SOWCode}}</span>
                    </td>
                    <td>{{task.ProjectCode}}</td>
                    <td>{{task.ShortTitle}}</td>
                    <td>{{task.ClientLegalEntity}}</td>
                    <td>{{task.ProjectType}}</td>

                    <td>{{task.PrimaryResources}}</td>
                    <td>{{task.POC}}</td>
                    <td>{{task.TA}}</td>
                    <td>{{task.Molecule}}</td>
                    <td [ngClass]="{'blueColor' : task.isBlueIndicator,'redColor': task.isRedIndicator,'greenColor': task.isGreenIndicator}">
                        <ng-container [ngSwitch]="task.Status">
                            <span *ngSwitchCase="'Audit In Progress'">CS Audit</span>
                            <span *ngSwitchCase="'Pending Closure'">Finance Audit</span>
                            <span *ngSwitchDefault>{{task.Status}}</span>
                        </ng-container>
                    </td>
                    <td class="lastColumnWidth">
                        <div>
                            <p-tieredMenu [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'" #menu class="projectSlider" [model]="popItems" [popup]="true"></p-tieredMenu>
                            <i class="pi pi-ellipsis-v"  style="font-size:2em;cursor: pointer;" (click)="storeRowData(rowData,menu); menu.show($event);"></i>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td style="text-align:center" [attr.colspan]="11">
                        No project found
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>

<!--***********************************************************************************
                     //  sidebar to display project details
*********************************************************************************** -->

<div *ngIf="pmObject.isProjectRightSideVisible" class="ng-right-side-overlay">
    <p-sidebar [(visible)]="pmObject.isProjectRightSideVisible" position="right" [baseZIndex]="10000" [style]="{width:'28em'}">
        <p-scrollPanel [style]="{'width': '100%', 'height': '95vh'}">
            <p-table [value]="projectViewDataArray" [style]="{'font-size':'13px','min-height': '400px'}" styleClass="p-datatable-cactus p-datatable-sm p-datatable-gridlines">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Name</th>
                        <th>Value</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowData let-task style="overflow: auto">
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Project ID</td>
                        <td>{{task.ProjectAttributes.ID}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">SOW Code</td>
                        <td>{{task.SOWSelect.SOWCode}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Project Code</td>
                        <td>{{task.ProjectAttributes.ProjectCode}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">ClientLegalEntity</td>
                        <td>{{task.ProjectAttributes.ClientLegalEntity}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Sub Division</td>
                        <td>{{task.ProjectAttributes.SubDivision}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Billing Entity</td>
                        <td>{{task.ProjectAttributes.BillingEntity}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Billed By</td>
                        <td>{{task.ProjectAttributes.BilledBy}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Practice Area</td>
                        <td>{{task.ProjectAttributes.PracticeArea}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Priority</td>
                        <td>{{task.ProjectAttributes.Priority}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Current Milestone</td>
                        <td>{{task.ProjectAttributes.Milestone}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Project Status</td>
                        <td>
                            <ng-container [ngSwitch]="task.ProjectAttributes.ProjectStatus">

                                <span *ngSwitchCase="'Audit In Progress'">CS Audit</span>
                                <span *ngSwitchCase="'Pending Closure'">Finance Audit</span>
                                <span *ngSwitchDefault>{{task.ProjectAttributes.ProjectStatus}}</span>
                            </ng-container>


                        </td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Client POC</td>

                        <td>{{task.ProjectAttributes.PointOfContact1Text}}<br /> {{task.ProjectAttributes.PointOfContact2Text}}
                        </td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Molecule</td>
                        <td>{{task.ProjectAttributes.Molecule}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Therapeutic Area</td>
                        <td>{{task.ProjectAttributes.TherapeuticArea}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Indication</td>
                        <td>{{task.ProjectAttributes.Indication}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">PUB Support Required</td>
                        <td>{{task.ProjectAttributes.PUBSupportRequired ? "Yes" : "No" }}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">PUB Support Status</td>
                        <td>{{task.ProjectAttributes.PUBSupportStatus}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Project Title</td>
                        <td>{{task.ProjectAttributes.ProjectTitle}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Alternate ID/ Short Title</td>
                        <td>{{task.ProjectAttributes.AlternateShortTitle}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">End Use of Deliverable</td>
                        <td>{{task.ProjectAttributes.EndUseofDeliverable}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">SOW Box Link</td>
                        <td>{{task.ProjectAttributes.SOWBoxLink}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Conference / Journal</td>
                        <td>{{task.ProjectAttributes.ConferenceJournal}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Authors</td>
                        <td>{{task.ProjectAttributes.Authors}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Comments</td>
                        <td>{{task.ProjectAttributes.Comments}}</td>
                    </tr>
                    <tr *ngIf="enableCountFields">
                        <td [ngStyle]="{'color':'#d7181f'}">Reference Count </td>
                        <td>{{task.ProjectAttributes.ReferenceCount}}</td>
                    </tr>
                    <tr *ngIf="enableCountFields">
                        <td [ngStyle]="{'color':'#d7181f'}">Slide Count</td>
                        <td>{{task.ProjectAttributes.SlideCount}}</td>
                    </tr>
                    <tr *ngIf="enableCountFields">
                        <td [ngStyle]="{'color':'#d7181f'}">Page Count</td>
                        <td>{{task.ProjectAttributes.PageCount}}</td>
                    </tr>
                    <tr *ngIf="enableCountFields">
                        <td [ngStyle]="{'color':'#d7181f'}">Annotation/Binder </td>
                        <td>{{task.ProjectAttributes.AnnotationBinder }}</td>
                    </tr>
                    <tr>
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}"></td>
                    </tr>
                    <tr *ngIf="task.Timeline.Standard.IsStandard">
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}" align="center">Standard Project</td>
                    </tr>
                    <tr *ngIf="task.Timeline.Standard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Service</td>
                        <td>{{task.Timeline.Standard.Service}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.Standard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Proposed Start Date</td>
                        <td>{{task.Timeline.Standard.ProposedStartDate | date:'MMM dd yyyy'}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.Standard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Proposed End Date</td>
                        <td>{{task.Timeline.Standard.ProposedEndDate | date:'MMM dd yyyy'}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.NonStandard.IsStandard">
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}" align="center">Non Standard Project</td>
                    </tr>
                    <tr *ngIf="task.Timeline.NonStandard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Deliverable Type</td>
                        <td>{{task.Timeline.NonStandard.DeliverableType}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.NonStandard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Sub Type</td>
                        <td>{{task.Timeline.NonStandard.SubDeliverable}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.NonStandard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Service</td>
                        <td>{{task.Timeline.NonStandard.Service}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.NonStandard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Proposed Start Date</td>
                        <td>{{task.Timeline.NonStandard.ProposedStartDate | date:'MMM dd yyyy'}}</td>
                    </tr>
                    <tr *ngIf="task.Timeline.NonStandard.IsStandard">
                        <td [ngStyle]="{'color':'#d7181f'}">Proposed End Date</td>
                        <td>{{task.Timeline.NonStandard.ProposedEndDate | date:'MMM dd yyyy'}}</td>
                    </tr>
                    <tr>
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}"></td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Currency</td>
                        <td>{{task.FinanceManagement.Currency}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Budget Hours</td>
                        <td>{{task.FinanceManagement.BudgetHours}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Project SOW</td>
                        <td>
                            <span *ngIf="task.FinanceManagement.ProjectSOW.length">
                                <a href="{{task.FinanceManagement.ProjectSOW}}" target="_blank" style="color:red">Click
                                    here</a>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}"></td>
                    </tr>
                    <tr>
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}" align="center">Budget</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Total</td>
                        <td>{{task.FinanceManagement.Budget.Total}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Revenue</td>
                        <td>{{task.FinanceManagement.Budget.Net}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">OOP</td>
                        <td>{{task.FinanceManagement.Budget.OOP}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Tax</td>
                        <td>{{task.FinanceManagement.Budget.Tax}}</td>
                    </tr>
                    <tr>
                        <td colspan="2" [ngStyle]="{'color':'#d7181f'}"></td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">CM Access</td>
                        <td>{{task.ProjectAttributes.ActiveCM1Text}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">CM Owner</td>
                        <td>{{task.ProjectAttributes.ActiveCM2Text}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Delivery Access</td>
                        <td>{{task.ProjectAttributes.ActiveDelivery1Text}}</td>
                    </tr>
                    <tr>
                        <td [ngStyle]="{'color':'#d7181f'}">Delivery Owner</td>
                        <td>{{task.ProjectAttributes.ActiveDelivery2Text}}</td>
                    </tr>
                </ng-template>
            </p-table>
        </p-scrollPanel>
    </p-sidebar>
</div>
<!--***********************************************************************************
                     //  dialog to move to Sow
*********************************************************************************** -->
<div *ngIf="pmObject.isMoveProjectToSOWVisible">
    <p-dialog [(visible)]="pmObject.isMoveProjectToSOWVisible" [modal]="true" [style]="{width: '500px'}" [closable]="false" [draggable]="true">
        <p-header>
            Move Project To SOW
        </p-header>
        <div class="pdialogButton p-col-12  p-grid p-jc-end">
            <button type="button " pButton class="p-mx-1 p-button-raised p-button-danger cls_sowMove" (click)="performSOWMove()" label="Move">
                    <i class="fa fa-exchange" aria-hidden="true" style="padding: 0px 8px 0px 2px;"></i>
                </button>

            <button type="button " pButton icon="pi pi-times " class="p-button-raised p-button-danger cls_closeSow" (click)="closeMoveSOW()" label="Cancel"></button>
        </div>

        <div class="p-mx-1 p-mt-4 p-grid">
            <span class="p-col p-px-0 p-float-label">
                    <p-dropdown inputId="dropdown" [options]="Statuses" appendTo="body" [autoDisplayFirst]="false" [options]="sowDropDownArray" [(ngModel)]="newSelectedSOW"   [showClear]="true"
                    [style]="{width:'100%'}"></p-dropdown>
                    <label class="p-px-0 mainlable" for="dropdown">SOW Code</label>
                </span>
        </div>
    </p-dialog>
</div>

<!--***********************************************************************************
                     //  dialog to cancel project
   *********************************************************************************** -->
<div *ngIf="pmObject.isReasonSectionVisible">
    <p-dialog [(visible)]="pmObject.isReasonSectionVisible" [modal]="true" [style]="{width: '700px'}" [closable]="false">
        <p-header>
            Cancel Project
        </p-header>
        <div class="pdialogButton p-col-12 p-grid p-jc-end">
            <button type="button " pButton icon="pi pi-save" class="p-mx-1 p-button-raised p-button-danger " (click)="saveCancelProject()" label="Confirm"></button>

            <button type="button " pButton icon="pi pi-times " class="p-button-raised p-button-danger cls_closeSow" (click)="pmObject.isReasonSectionVisible=false" label="Cancel"></button>
        </div>

        <div class="p-mx-1 p-mt-4 p-grid">
            <span class="p-col p-px-0 p-float-label">
                    <p-dropdown inputId="dropdown" appendTo="body" [autoDisplayFirst]="false" [options]="cancelReasonArray" [(ngModel)]="selectedReasonType"   [showClear]="true"
                    [style]="{width:'100%'}"></p-dropdown>
                    <label class="p-px-0 mainlable" for="dropdown">Reason Type</label>
                </span>
        </div>

        <div class="p-mx-1 p-mt-4 p-grid">
            <span class="p-col p-px-0 p-float-label">
                    <textarea inputId="textarea" rows="3" cols="30" [(ngModel)]="selectedReason" pInputTextarea></textarea>
                    <label class="p-px-0 mainlable" for="textarea">Reason Type</label>
                </span>
        </div>
    </p-dialog>
</div>

<!--*************************************************************************************
//  dialog to show expense data
*************************************************************************************** -->
<p-dialog *ngIf="showExpenseEnable" header="{{projectTitle}}" [contentStyle]="{'max-height':'96vh'}" [style]="{'width': '96vw'}" [modal]="true" [draggable]="false" appendTo='body' [(visible)]="showExpenseEnable" [closable]="false">

    <div class="p-d-flex p-flex-column" style="padding: 5vw;" *ngIf="expensedataloaderEnable">
        <div id="modalInnerLoader"></div>
        <div id="modalInnerLoaderText">Loading...</div>
    </div>

    <div class="pdialogButton p-col-12 p-grid p-jc-end">
        <button type="button " pButton icon="pi pi-times " class="p-button-raised p-button-danger cls_closeExpense" (click)="showExpenseEnable=false" label="Close"></button>
    </div>

    <p-table #dt2 *ngIf="!expensedataloaderEnable" [columns]="ExpenseCols" [value]="projectExpenses" [paginator]="true" [rows]="10" (sortFunction)="customSort($event)" [customSort]="true" [rowsPerPageOptions]="[10,25,50]" [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        [style]="{'font-size':'13px','min-height': '400px'}" styleClass="p-datatable-cactus p-datatable-gridlines">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th style="width: 4em;">S.No</th>
                <th *ngFor="let col of columns" [ngStyle]="{'width': col.field === 'Status' ? '15em !important':(col.field === 'Category'|| col.field === 'ClientAmount'|| col.field === 'ClientCurrency') ? '11.5em !important':'' }" [pSortableColumn]="col.field" [hidden]="!col.visibility">
                    <div class="p-d-flex p-jc-between p-ai-center">
                        {{col.header}}
                        <p-sortIcon *ngIf="col.header != '' " [field]="col.field"></p-sortIcon>
                        <p-columnFilter *ngIf="col.header != ''" [field]="col.field" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                            <ng-template pTemplate="header">
                                <div class="p-px-3 p-pt-3 p-pb-0">
                                    <span class="p-text-bold"> {{col.header}} Picker</span>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-multiSelect [virtualScroll]="true" [itemSize]="30" [ngModel]="value" [options]="expenseColArray[col.field]" placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                    <ng-template let-option pTemplate="item">
                                        <div class="p-multiselect-representative-option">
                                            <span class="p-ml-1">{{option.label}}</span>
                                        </div>
                                    </ng-template>
                                </p-multiSelect>
                            </ng-template>
                        </p-columnFilter>
                    </div>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-node="rowData" let-rowData let-columns="columns" let-rowIndex="rowIndex">
            <tr>
                <td>
                    {{rowIndex+1}}
                </td>
                <td *ngFor="let col of columns;index as i" [hidden]="!col.visibility" class="ui-resizable-column">
                    <ng-container *ngIf="col.field != 'Created' && col.field != 'Modified' &&  col.field != '' ">
                        {{rowData[col.field]}}
                    </ng-container>
                    <ng-container *ngIf="col.field == 'Modified'">
                        {{rowData[col.field] | date:'MMM dd, yyyy' }}
                    </ng-container>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td [attr.colspan]="columns.length" style="text-align: center;font-weight:bold;">
                    No records found
                </td>
            </tr>
        </ng-template>
    </p-table>
</p-dialog>



<!--*************************************************************************************
//  dialog to change deliverable Type
*************************************************************************************** -->
<p-dialog [(visible)]="changeDeliverable" [modal]="true" [style]="{width: '600px'}" [closable]="false">
    <p-header>
        Change Deliverable Type
    </p-header>

    <div class="pdialogButton p-col-12 p-grid p-jc-end">
        <button type="button " pButton icon="pi pi-save" class="p-mx-1 p-button-raised p-button-danger cls_showDeliverable" (click)="saveDeliverable()" label="Save"></button>

        <button type="button " pButton icon="pi pi-times " class="p-button-raised p-button-danger cls_closeDeliverable" (click)="closeDeliverable()" label="Cancel"></button>
    </div>

    <div class="p-mx-1 p-mt-4 p-grid">
        <span class="p-col p-px-0 p-float-label">
            <p-dropdown inputId="dropdown" [options]="deliverableTypeOptions" appendTo="body" [autoDisplayFirst]="false"  [(ngModel)]="newDeliverable"   [showClear]="true"
            [style]="{width:'100%'}"></p-dropdown>
            <label class="p-px-0 mainlable" for="dropdown">Deliverable Type</label>
        </span>
    </div>
</p-dialog>



<!--*************************************************************************************
//  dialog to change project date
*************************************************************************************** -->
<p-dialog [(visible)]="updateProjectDate" [modal]="true" [style]="{width: '580px'}" [closable]="false">
    <p-header>
        Change Project Date
    </p-header>
    <div class="pdialogButton p-col-12 p-grid p-jc-end">
        <button type="button " pButton icon="pi pi-save" class="p-mx-1 p-button-raised p-button-danger cls_showProjDate" (click)="saveProjectDate()" label="Save"></button>

        <button type="button " pButton icon="pi pi-times" class="p-button-raised p-button-danger cls_closeProjDate" (click)="closeProjectDate()" label="Cancel"></button>
    </div>
    <div class="ui-grid-row mt-20">
        <div class="ui-grid-col-4">Proposed Start Date</div>
        <p-calendar  class="pcalendarClass" [(ngModel)]="proposedStartDate"   [disabledDays]="[0,6]"   [readonlyInput]="true"   dateFormat="dd M, yy"   appendTo="body"   hideOnDateTimeSelect="true"   [required]="true"   [stepMinute]="15"   [showIcon]="true" [showOnFocus]="false"
              [monthNavigator]="true"   [yearNavigator]="true"     yearRange="{{yearRange}}" [inputStyle]="{'width': '80%', 'min-width': '80%'}"  inputStyleClass="ngPrime-red" (onClose)="projectDateChange('start')" [disabled]="disableStartDate" [minDate]="minDateValue">
            </p-calendar>
    </div>
    <div class="ui-grid-row mt-20">
        <div class="ui-grid-col-4">Proposed End Date</div>
        <p-calendar  class="pcalendarClass"   [(ngModel)]="proposedEndDate"   [disabledDays]="[0,6]"   [readonlyInput]="true"   dateFormat="dd M, yy"   appendTo="body"   hideOnDateTimeSelect="true"   [required]="true"   [stepMinute]="15"   [showIcon]="true" [showOnFocus]="false"
              [monthNavigator]="true"   [yearNavigator]="true"     yearRange="{{yearRange}}" [inputStyle]="{'width': '80%', 'min-width': '80%'}"  inputStyleClass="ngPrime-red" (onClose)="projectDateChange('end')">
            </p-calendar>
    </div>

</p-dialog>





<app-timeline-history #timelineRef></app-timeline-history>
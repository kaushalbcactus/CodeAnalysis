<div class="p-col">
    <div class="p-col-12 p-md-12 p-lg-12 f-right">
        <div style="display: -webkit-inline-box;">
            <div class="box" style="margin-right: 20px;" *ngIf="constantService.userPermission.isFDUserAdmin">
                <button pButton type="button" class="fdBtn" label="Schedule OOP Invoice" (click)="openPopup('scheduleOopModal')" style="float:left"></button>
            </div>
            <div class="box" style="margin-right: 20px;" *ngIf="constantService.userPermission.isFDUserAdmin">
                <button pButton type="button" class="fdBtn" label="Mark As Payment" (click)="openPopup('markAsPaymentModal')" style="float:left"></button>
            </div>
            <div class="box">
                <i [hidden]="isLoaderenable && approvedBillableRes.length === 0" style="font-size: 1.8em;cursor: pointer;vertical-align: -webkit-baseline-middle;" (click)=" fdDataShareServie.convertToExcelFile(ab)" title="Export To Excel" class="fa fa-fw fa-file-excel-o"></i>
            </div>
        </div>
    </div>
    <div style="clear: both;"></div>
</div>




<!--**********************************************************************************************
                                                         loader enable 
*********************************************************************************************** -->
<div fxLayout="column" style="padding: 10vw;width: 100%;" fxLayoutAlign="center center" *ngIf="isLoaderenable">
    <div id="scInnerLoader"></div>
    <div id="scInnerLoaderText">Loading...</div>
</div>



<div class="financeTable" [hidden]="isLoaderenable && approvedBillableRes.length === 0">
    <p-table #ab [columns]="approvedBillableCols" [value]="approvedBillableRes" [paginator]="true" [rows]="10" [(selection)]="selectedAllRowsItem" (onRowSelect)="onRowSelect($event)" (onRowUnselect)="onRowUnselect($event)" selectionMode="" exportFilename="Approved_Billable_Expenses">
        <ng-template pTemplate="header" let-columns let-rowData="rowData">

            <tr>
                <th>S.No</th>
                <th style="width: 2.25em">
                    <p-tableHeaderCheckbox (click)="selectAllRows()"></p-tableHeaderCheckbox>
                </th>
                <th *ngFor="let col of columns" [pSortableColumn]="col.field" [hidden]="!col.visibility">
                    {{col.header}}
                    <p-sortIcon *ngIf="col.header != '' " [field]="col.field"></p-sortIcon>
                </th>
            </tr>
            <tr>
                <th></th>
                <th></th>
                <th *ngFor="let col of columns" [ngSwitch]="col.field" class="ui-fluid" [hidden]="!col.visibility">
                    <ng-container *ngIf="col.field">
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'ProjectCode'" [options]="appBillableColArray.ProjectCode" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'SOWCode'" [options]="appBillableColArray.SOWCode" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'Number'" [options]="appBillableColArray.Number" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'DateSpend'" [options]="appBillableColArray.DateSpend" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'VendorName'" [options]="appBillableColArray.VendorName" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'RequestType'" [options]="appBillableColArray.RequestType" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'ExpenseType'" [options]="appBillableColArray.ExpenseType" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'PaymentMode'" [options]="appBillableColArray.PaymentMode" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'ClientAmount'" [options]="appBillableColArray.ClientAmount" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'ClientCurrency'" [options]="appBillableColArray.ClientCurrency" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'PayingEntity'" [options]="appBillableColArray.PayingEntity" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'Status'" [options]="appBillableColArray.Status" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'SpendDate'" [options]="appBillableColArray.SpendDate" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'Created'" [options]="appBillableColArray.Created" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'ModifiedBy'" [options]="appBillableColArray.ModifiedBy" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')"
                            (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                        <p-multiSelect (keydown.enter)="$event.preventDefault()" resetFilterOnHide="true" *ngSwitchCase="'Modified'" [options]="appBillableColArray.Modified" defaultLabel="All" [maxSelectedLabels]="1" (onChange)="ab.filter($event.value, col.field, 'in')" (input)="optionFilter($event)"
                            (onPanelShow)="isOptionFilter=true;">
                        </p-multiSelect>
                    </ng-container>
                </th>
            </tr>

        </ng-template>
        <ng-template pTemplate="body" let-node="rowData" let-rowData let-columns="columns" let-rowIndex="rowIndex">

            <tr>
                <td>{{rowIndex+1}}</td>
                <td>
                    <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                </td>

                <td *ngFor="let col of columns;index as i" [hidden]="!col.visibility">
                    {{rowData[col.field]}}
                    <ng-container *ngIf="col.field == ''">
                        <div>
                            <p-menu #popupMenu [popup]="true" [model]="items" styleClass="borderMenu"></p-menu>
                            <i class="pi pi-ellipsis-v" style="font-size:2em;top: 100px !important;cursor: pointer;" (click)="openTableAtt(rowData, popupMenu);popupMenu.show($event);"></i>
                        </div>
                    </ng-container>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<div *ngIf="!isLoaderenable && approvedBillableRes.length == 0" style="color:red;text-align: center;padding-top: 20px;">
    No data available.
</div>
<!-- Right Side Bar -->
<p-sidebar [(visible)]="rightSideBar" position="right" [style]="{overflow: 'auto'}" styleClass="ui-sidebar-md">
    <ng-container *ngIf="rightSideBar">
        <app-table-attribute [rowItemData]="rowItemDetails"></app-table-attribute>
    </ng-container>
</p-sidebar>

<!-- Mark As Payment Modal -->
<!-- <p-dialog header="Mark As Payment" [(visible)]="markAsPaymentModal" [modal]="true" [draggable]="false" [responsive]="true" [style]="{'width': '70%', 'top':'0px'}" [contentStyle]="{overflow: 'visible'}" [maximizable]="false" [closable]="false">

    <div class='UserButton' fxLayout="row" fxLayoutAlign="end center">

        <button type="button" pButton icon="pi pi-check" id="saveClient" [ngStyle]="{'margin-right':   '5px','cursor':'pointer' }" label="Mark As Payment" (click)="onSubmit(null,'markAsPayment_form')"></button>

        <button type="button" pButton icon="pi pi-times" id="cancelClient" label="Cancel" (click)="markAsPaymentModal=false;cancelFormSub('markAsPayment_form')"></button>

    </div>

    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="5px">

        <form [formGroup]="markAsPayment_form" class="p-col">

            <div class="p-grid">
                <div class="p-grid p-col">
                    <div class="p-col-4"><span class="compulsory">*</span>Reference Number</div>
                    <div class="p-col-8">
                        <input type="text" pInputText formControlName="Number" style="width: 100%;" />
                        <div *ngIf="formSubmit.isSubmit && isValidMarkAsPaymentForm.Number.errors">
                            <div *ngIf="isValidMarkAsPaymentForm.Number.errors.required" style="color:red;">Please provide Reference number.</div>
                        </div>
                    </div>
                </div>
                <div class="p-grid p-col">
                    <div class="p-col-4"><span class="compulsory">*</span>Payment Date</div>
                    <div class="p-col-8">

                        <p-calendar styleClass="pCalendarBtn" formControlName="DateSpend" [showIcon]="true" dateFormat="MMM dd , yy"   [showOnFocus]="false"   [monthNavigator]="true" yearRange="{{yearRange}}" [disabledDays]="[0,6]" [yearNavigator]="true" [readonlyInput]="true"
                            placeholder="Payment date">
                        </p-calendar>

                        <div *ngIf="formSubmit.isSubmit && isValidMarkAsPaymentForm.DateSpend.errors">
                            <div *ngIf="isValidMarkAsPaymentForm.DateSpend.errors.required" style="color:red;">Please provide Payment Date.</div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="p-grid">
                <div class="p-grid p-col">
                    <div class="p-col-4"><span class="compulsory">*</span>Payment Mode</div>
                    <div class="p-col-8">
                        <p-dropdown resetFilterOnHide="true" [options]="paymentModeArray" [showClear]="false" placeholder="Select a Payment Mode" [style]="{'width':'100%'}" formControlName="PaymentMode" optionLabel="value" onfocus='this.size=10;'>
                        </p-dropdown>
                        <div *ngIf="formSubmit.isSubmit && isValidMarkAsPaymentForm.PaymentMode.errors">
                            <div *ngIf="isValidMarkAsPaymentForm.PaymentMode.errors.required" style="color:red;">Please provide Payment Mode.</div>
                        </div>
                    </div>
                </div>
                <div class="p-grid p-col">
                    <div class="p-col-4"><span class="compulsory">*</span>Upload File</div>
                    <div class="p-col-8">

                        <div class="file-upload" #fileuploderView>
                            <div class="file-select">
                                <div class="file-select-button" id="fileName">Choose File</div>
                                <div class="file-select-name" id="noFile">No file chosen...</div>
                                <input type="file" name="chooseFile" id="chooseFile" (change)="onFileChange($event, 'ApprovedExpenseFiles')" formControlName="ApproverFileUrl">
                            </div>
                        </div>
                        <div *ngIf="formSubmit.isSubmit && isValidMarkAsPaymentForm.ApproverFileUrl.errors">
                            <div *ngIf="isValidMarkAsPaymentForm.ApproverFileUrl.errors.required" style="color:red;">Please provide file.</div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</p-dialog> -->

<!-- Approve Accept Reject Modal -->
<!-- <p-dialog header="Schedule OOP Invoice" [(visible)]="scheduleOopModal" [modal]="true" [draggable]="false" [responsive]="true" [style]="{'width': '55%', 'top':'0px'}" [maximizable]="false" (onHide)="cancelFormSub('scheduleOopInvoice_form')">

    <form [formGroup]="scheduleOopInvoice_form">
        <div class="ui-g">
            <div class="ui-g-2">
                Project Code
            </div>
            <div class="ui-g-10">
                <input type="text" pInputText formControlName="ProjectCode" style="width: 72%;">
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.ProjectCode.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.ProjectCode.errors.required" style="color:red;">Please Check Project Code.
                    </div>
                </div>
            </div>

            <div class="ui-g-2">
                PO Number
            </div>
            <div class="ui-g-8">

                <div class="ui-g-6" style="padding-left:0">
                    <p-dropdown resetFilterOnHide="true" [options]="poNames" filter="true" formControlName="PONumber" [style]="{'width':'30.0em'}" placeholder="Select PO Number" optionLabel="Number" (onChange)="poChange($event)">
                        <ng-template let-item pTemplate="selectedItem">
                            <span style="vertical-align:middle">{{item.label}}
                                {{item.value.Name ? ' -- '+ item.value.Name:'' }}
                            </span>
                        </ng-template>
                        <ng-template let-item pTemplate="item">
                            <div class="ui-helper-clearfix" style="position: relative;">
                                <div style="font-size:14px;float: left;margin-top:4px;width: 300px;line-height: 20px;">
                                    {{item.label}} {{item.value.Name ? ' -- '+ item.value.Name:'' }}
                                </div>
                            </div>
                        </ng-template>
                    </p-dropdown>
                    <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.PONumber.errors">
                        <div *ngIf="isValidScheduleOOPInvoiceForm.PONumber.errors.required" style="color:red;">Please Select one of PONumber.
                        </div>
                    </div>
                </div>

            </div>
            <div class="ui-g-2">
                OOP Balance <span *ngIf="poItem">{{oopBalance}}</span>
            </div>

            <div class="ui-g-2">
                Schedule Type
            </div>
            <div class="ui-g-10">
                <input type="text" pInputText formControlName="ScheduledType">
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.ScheduledType.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.ScheduledType.errors.required" style="color:red;">Please Select one of Scheduled Type.
                    </div>
                </div>
            </div>
            <div class="ui-g-2">
                Amount
            </div>
            <div class="ui-g-10">
                <input type="text" pInputText formControlName="Amount">
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.Amount.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.Amount.errors.required" style="color:red;">Please Select one of Amount.
                    </div>
                </div>
            </div>
            <div class="ui-g-2">
                Currency
            </div>
            <div class="ui-g-10">
                <input type="text" pInputText formControlName="Currency">
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.Currency.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.Currency.errors.required" style="color:red;">Please Select one of Currency.
                    </div>
                </div>
            </div>
            <div class="ui-g-2">
                Schedule Date
            </div>
            <div class="ui-g-10 box1">
                <p-calendar styleClass="pCalendarBtn" [showIcon]="true" [monthNavigator]="true" [readonlyInput]="true" dateFormat="dd M , yy" yearRange="2019:2030" [disabledDays]="[0,6]" [yearNavigator]="true" [inputStyle]="{'width': '80%', 'min-width': '80%','padding':'0px'}"
                    formControlName="ScheduledDate">
                </p-calendar>
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.ScheduledDate.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.ScheduledDate.errors.required" style="color:red;">Please select Schedule Date.
                    </div>
                </div>
            </div>
            <div class="ui-g-2">
                POC Name
            </div>
            <div class="ui-g-10">
                <p-dropdown resetFilterOnHide="true" [options]="listOfPOCs" formControlName="POCName" placeholder="Select POC Name" optionLabel="FullName" filter="true" (onChange)="pocChange($event)">
                </p-dropdown>
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.POCName.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.POCName.errors.required" style="color:red;">Please provide POC Name.</div>
                </div>
            </div>

            <div class="ui-g-2">Address Type</div>
            <div class="ui-g-10">
                <p-dropdown resetFilterOnHide="true" [options]="addressTypes" formControlName="AddressType" placeholder="Select a Address Type" optionLabel="label">
                </p-dropdown>
                <div *ngIf="formSubmit.isSubmit && isValidScheduleOOPInvoiceForm.AddressType.errors">
                    <div *ngIf="isValidScheduleOOPInvoiceForm.AddressType.errors.required" style="color:red;">Please provide Address type.</div>
                </div>
            </div>

        </div>
    </form>
    <p-footer>
        <button pButton type="button" class="fdBtn" label="Add To Schedule Invoice" [disabled]="submitBtn.isClicked" (click)="onSubmit(null,'scheduledOOP')"></button>
    </p-footer>
</p-dialog> -->

<!-- Toast Messages -->
<p-toast position="bottom-center" key="approvedToast"></p-toast>
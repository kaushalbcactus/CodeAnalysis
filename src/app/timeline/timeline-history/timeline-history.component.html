<p-sidebar [(visible)]="displayBody" position="bottom" styleClass="p-sidebar-sm">

    <p-table #timelineTable id="tblTimeline" [columns]="timelineHeader" [value]="timelineData" [scrollable]="true" scrollHeight="400px" 
    [virtualScroll]="true" [lazy]="lazy" [rows]="10" [rowTrackBy]="rowTrackBy" [virtualRowHeight]="34" (onLazyLoad)="loadData($event)"
        [lazyLoadOnInit]="false" [totalRecords]="totalRecords" [loading]="loading" styleClass="p-datatable-cactus p-datatable-gridlines">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th width="4%">Sr.No.</th>
                <th *ngFor="let col of columns" [pSortableColumn]="col.field" [width]="col.width">
                    {{col.header}}
                    <p-sortIcon [field]="col.field"></p-sortIcon>
                    <p-columnFilter *ngIf="col.field != 'file_uploaded'  && col.field !='activity_description' " [field]="col.field" matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                        <ng-template pTemplate="header">
                            <div class="p-px-3 p-pt-3 p-pb-0">
                                <span class="p-text-bold"> {{col.header}} Picker</span>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-multiSelect [ngModel]="value" [options]="col.options" placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                <ng-template let-option pTemplate="item">
                                    <div class="p-multiselect-representative-option">
                                        <span class="p-ml-1">{{option.label}}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                        </ng-template>
                        <!-- <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-multiSelect *ngIf="col.field == 'date_time'" [ngModel]="value" 
                                [options]="filter.dates" 
                                placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                <ng-template let-option pTemplate="item">
                                    <div class="p-multiselect-representative-option">
                                        <span class="p-ml-1">{{option.label}}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                            <p-multiSelect *ngIf="col.field == 'activity_type'" [ngModel]="value" 
                                [options]="filter.activityType" 
                                placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                <ng-template let-option pTemplate="item">
                                    <div class="p-multiselect-representative-option">
                                        <span class="p-ml-1">{{option.label}}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                            <p-multiSelect *ngIf="col.field == 'activity_sub_type'" [ngModel]="value" 
                                [options]="filter.activitySubType" 
                                placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                <ng-template let-option pTemplate="item">
                                    <div class="p-multiselect-representative-option">
                                        <span class="p-ml-1">{{option.label}}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                            <p-multiSelect *ngIf="col.field == 'activity_by'" [ngModel]="value" 
                                [options]="filter.activityBy" 
                                placeholder="All" (onChange)="filter($event.value)" optionLabel="label">
                                <ng-template let-option pTemplate="item">
                                    <div class="p-multiselect-representative-option">
                                        <span class="p-ml-1">{{option.label}}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                        </ng-template> -->
                    </p-columnFilter>
                </th>
            </tr>
            <!-- <tr>
                <th></th>
                <th *ngFor="let col of columns" [ngSwitch]="col.field">
                    <p-multiSelect *ngSwitchCase="'date_time'" [(ngModel)]="datesValues" [panelStyle]="{minWidth:'12em'}" appendTo="body" resetFilterOnHide="true" [style]="{'width':'100%'}" [options]="filter.dates" defaultLabel="All" (keydown.enter)="$event.preventDefault()"
                        (onChange)="timelineTable.filter($event.value, col.field, 'contains','test')" resetFilterOnHide="true"></p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'activity_type'" [panelStyle]="{minWidth:'12em'}" appendTo="body" [style]="{'width':'100%'}" [options]="filter.activityType" defaultLabel="All" (keydown.enter)="$event.preventDefault()" (onChange)="timelineTable.filter($event.value, col.field, 'in')"
                        resetFilterOnHide="true"></p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'activity_sub_type'" [panelStyle]="{minWidth:'12em'}" appendTo="body" [style]="{'width':'100%'}" [options]="filter.activitySubType" defaultLabel="All" (keydown.enter)="$event.preventDefault()" (onChange)="timelineTable.filter($event.value, col.field, 'in')"
                        resetFilterOnHide="true"></p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'activity_by'" [panelStyle]="{minWidth:'12em'}" appendTo="body" [style]="{'width':'100%'}" [options]="filter.activityBy" defaultLabel="All" (keydown.enter)="$event.preventDefault()" (onChange)="timelineTable.filter($event.value, col.field, 'in')"
                        resetFilterOnHide="true"></p-multiSelect>
                </th>
            </tr> -->
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-i="rowIndex">
            <tr>
                <td width="4%">{{i+1}}</td>
                <td width="14%">{{rowData.date_time | date: 'MMM d, y, hh:mm a'}}</td>
                <td width="14%">{{rowData.activity_type}}</td>
                <td width="16%">{{rowData.activity_sub_type}}</td>
                <td width="16%">{{rowData.activity_by}}</td>
                <td width="20%">{{rowData.activity_description}}</td>
                <td width="16%"><a href="{{rowData.file_uploaded}}" class="download" download *ngIf="rowData.file_uploaded !== ''">View Docs</a></td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td [attr.colspan]="columns.length">
                    No history found
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div class="timelineTableLoader" [hidden]='hideLoader'>
        <div id="timelineMainLoader"></div>
        <div id="timelineMainLoaderText">Loading...</div>
    </div>
</p-sidebar>
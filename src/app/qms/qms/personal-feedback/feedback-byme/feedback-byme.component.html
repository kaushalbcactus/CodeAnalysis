<div class="userdetails">
    <div class='customer-detail'  [hidden]="hideDetail">
        Name:
        <div id="cd-name">{{global.currentUser.title}}</div>
    </div>
    <div class='customer-detail'  [hidden]="hideDetail">
        Designation:
        <div id="cd-designation">{{global.currentUser.designation}}</div>
    </div>
    <a [hidden]="hideTable" (click)="downloadExcel(fb)" class="download-worksheet td-none"><i class="fa fa-download" aria-hidden="true"></i>
        Download worksheet</a>
</div>

<p-table #fb [columns]="feedbackColumns" [value]="feedbackRows"  [hidden]="hideTable">
    <ng-template pTemplate="header" let-columns>
        <tr>
            <ng-container *ngFor="let col of columns">
                <th [pSortableColumn]="col.field" *ngIf="!col.visibility">
                    {{col.header}}
                    <p-sortIcon [field]="col.field" ariaLabel="Activate to sort"
                        ariaLabelDesc="Activate to sort in descending order"
                        ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
                </th>
            </ng-container>
        </tr>
        <tr>
            <ng-container *ngFor="let col of columns">
                <th [ngSwitch]="col.field" *ngIf="!col.visibility">
                    <p-multiSelect *ngSwitchCase="'Date'" [style]="{'width':'100%'}" [options]="FBColArray.Date"
                        defaultLabel="Date" (onChange)="fb.filter($event.value, col.field, 'in')"
                        (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'Task'" [style]="{'width':'100%'}" [options]="FBColArray.Task"
                        defaultLabel="Task" (onChange)="fb.filter($event.value, col.field, 'in')"
                        (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'Type'" [style]="{'width':'100%'}" [options]="FBColArray.Type"
                        defaultLabel="Type" (onChange)="fb.filter($event.value, col.field, 'in')"
                        (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true">
                    </p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'Feedbackfor'" [style]="{'width':'100%'}"
                        [options]="FBColArray.Feedbackfor" defaultLabel="Feedback For"
                        (onChange)="fb.filter($event.value, col.field, 'in')" (keydown.enter)="$event.preventDefault()"
                        filter="true" resetFilterOnHide="true"></p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'FeedbackBy'" [style]="{'width':'100%'}"
                        [options]="FBColArray.FeedbackBy" defaultLabel="Feedback By"
                        (onChange)="fb.filter($event.value, col.field, 'in')" (keydown.enter)="$event.preventDefault()"
                        filter="true" resetFilterOnHide="true"></p-multiSelect>
                    <p-multiSelect *ngSwitchCase="'Rating'" [style]="{'width':'100%'}" [options]="FBColArray.Rating"
                        defaultLabel="Rating" (onChange)="fb.filter($event.value, col.field, 'in')"
                        (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true">
                    </p-multiSelect>
                </th>
            </ng-container>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
            <ng-container *ngFor="let col of columns">
                <td *ngIf="col.field != '' && !col.visibility">
                    {{rowData[col.field]}}
                </td>
            </ng-container>
        </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage" let-columns>
        <tr>
            <td [attr.colspan]="columns.length - 3">
                No Data found
            </td>
        </tr>
    </ng-template>
</p-table>
<div class="tableLoader" [hidden]='hideLoader'>
    <div id="mainLoader"></div>
    <div id="mainLoaderText">Loading...</div>
</div>
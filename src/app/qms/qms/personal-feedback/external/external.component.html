<div class="userdetails">
    <div class='customer-detail'>
        Name:
        <div id="cd-name">{{global.currentUser.title}}</div>
    </div>
    <div class='customer-detail'>
        Designation:
        <div id="cd-designation">{{global.currentUser.designation}}</div>
    </div>
    <a (click)="downloadExcel(qc)" class="download-worksheet td-none"><i class="fa fa-download" aria-hidden="true"></i></a>
</div>

<p-table #qc id="qcTable" [columns]="QCColumns" [value]="QCRows" exportFilename="Client Dissatisfaction"
    [hidden]="hideTable">
    <ng-template pTemplate="header" let-columns>
        <tr>
            <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                {{col.header}}
                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort"
                    ariaLabelDesc="Activate to sort in descending order"
                    ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
            </th>
        </tr>
        <tr>
            <th *ngFor="let col of columns" [ngSwitch]="col.field">
                <p-multiSelect *ngSwitchCase="'ID'" [style]="{'width':'100%'}" [options]="QCColArray.ID"
                    defaultLabel="ID" (onChange)="qc.filter($event.value, col.field, 'in')"
                    (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true"
                    (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1">
                </p-multiSelect>
                <p-multiSelect *ngSwitchCase="'Title'" [style]="{'width':'100%'}" [options]="QCColArray.Title"
                    defaultLabel="Title" (onChange)="qc.filter($event.value, col.field, 'in')"
                    (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true"
                    (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1">
                </p-multiSelect>
                <p-multiSelect *ngSwitchCase="'SentDate'" [style]="{'width':'100%'}" [options]="QCColArray.SentDate"
                    defaultLabel="Sent Date" (onChange)="qc.filter($event.value, col.field, 'in')"
                    (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true"
                    (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1">
                </p-multiSelect>
                <p-multiSelect *ngSwitchCase="'SentBy'" [style]="{'width':'100%'}" [options]="QCColArray.SentBy"
                    defaultLabel="Sent By" (onChange)="qc.filter($event.value, col.field, 'in')"
                    (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true"
                    (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1">
                </p-multiSelect>
                <p-multiSelect *ngSwitchCase="'Status'" [style]="{'width':'100%'}" [options]="QCColArray.Status"
                    defaultLabel="Status" (onChange)="qc.filter($event.value, col.field, 'in')"
                    (keydown.enter)="$event.preventDefault()" filter="true" resetFilterOnHide="true"
                    (input)="optionFilter($event)" (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1">
                </p-multiSelect>
                <p-multiSelect *ngSwitchCase="'SeverityLevel'" [style]="{'width':'100%'}"
                    [options]="QCColArray.SeverityLevel" defaultLabel="Severity Level"
                    (onChange)="qc.filter($event.value, col.field, 'in')" (keydown.enter)="$event.preventDefault()"
                    filter="true" resetFilterOnHide="true" (input)="optionFilter($event)"
                    (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1"></p-multiSelect>
                <p-multiSelect *ngSwitchCase="'Accountable'" [style]="{'width':'100%'}"
                    [options]="QCColArray.Accountable" defaultLabel="Accountable"
                    (onChange)="qc.filter($event.value, col.field, 'in')" (keydown.enter)="$event.preventDefault()"
                    filter="true" resetFilterOnHide="true" (input)="optionFilter($event)"
                    (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1"></p-multiSelect>
                <p-multiSelect *ngSwitchCase="'Segregation'" [style]="{'width':'100%'}"
                    [options]="QCColArray.Segregation" defaultLabel="Segregation"
                    (onChange)="qc.filter($event.value, col.field, 'in')" (keydown.enter)="$event.preventDefault()"
                    filter="true" resetFilterOnHide="true" (input)="optionFilter($event)"
                    (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1"></p-multiSelect>
                <p-multiSelect *ngSwitchCase="'BusinessImpact'" [style]="{'width':'100%'}"
                    [options]="QCColArray.BusinessImpact" defaultLabel="Business Impact"
                    (onChange)="qc.filter($event.value, col.field, 'in')" (keydown.enter)="$event.preventDefault()"
                    filter="true" resetFilterOnHide="true" (input)="optionFilter($event)"
                    (onPanelShow)="isOptionFilter=true;" [maxSelectedLabels]="1"></p-multiSelect>
            </th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
            <td *ngFor="let col of columns">
                <ng-container *ngIf="col.field != 'Title' &&  col.field != '' &&  col.field !== 'SentDate'">
                    {{rowData[col.field]}}
                </ng-container>
                <ng-container *ngIf="col.field === 'SentDate'">
                    {{rowData[col.field] | date:'MMM d, yyyy' }}
                </ng-container>
                <ng-container *ngIf="col.field == 'Title'">
                    <a [href]="rowData['fullUrl']" download> {{rowData[col.field]}}</a>
                </ng-container>
            </td>
        </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage" let-columns="columns">
        <tr>
            <td [attr.colspan]="9">
                No Data found
            </td>
        </tr>
    </ng-template>
</p-table>
<div class="tableLoader" [hidden]='hideLoader'>
    <div id="mainLoader"></div>
    <div id="mainLoaderText">Loading...</div>
</div>
